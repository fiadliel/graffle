var e,t,n;new Set(Object.keys({Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]})),(n=e||(e={})).QUERY="query",n.MUTATION="mutation",n.SUBSCRIPTION="subscription",function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(t||(t={}));const r=e=>e instanceof Error?e:Error(e+""),o=e=>{throw Error("Unhandled case: "+e)},i=e=>"object"==typeof e&&null!==e&&!Array.isArray(e),a=e=>{let t,n,r=!1;return{promise:new Promise(((e,r)=>{t=e,n=r})),isResolved:()=>r,resolve:n=>{if(r=!0,e?.strict&&r)throw Error("Deferred is already resolved. Attempted to resolve with: "+JSON.stringify(n));t(n)},reject:e=>n(e)}},s=(...e)=>{process.env.DEBUG&&console.log(...e)},u=(...e)=>(...t)=>{s(...e,...t)},l=(e,t,n=[])=>new Proxy(e,{get:(e,r,o)=>{const a=Reflect.get(e,r,o);return"_"===r&&0===n.length?a:i(a)?l(a,t,[...n,r]):t({property:r,path:n})??Reflect.get(e,r,o)}});new Proxy({},{get:()=>e=>e});const c=e=>"string"==typeof e,p=e=>null!==e,d=e=>e;class m extends Error{context;cause;name="ContextualError";constructor(e,t={},n=void 0){super(e,n),this.context=t,this.cause=n}}class f extends m{errors;name="ContextualAggregateError";constructor(e,t,n){super(e,t,void 0),this.errors=n}}const v=(e,t)=>"default"===e.errors[t]?e.defaults.errorChannel:e.errors[t],h={defaults:{errorChannel:"throw"},envelope:{enabled:!1,errors:{execution:!0,other:!1}},errors:{execution:"default",other:"default"}},y=(e,t)=>{if((n=e.output).envelope.enabled&&n.envelope.errors.execution&&!n.envelope.errors.other){if(t instanceof Error)throw t;return t.value}var n;const r=e.output,o=r.envelope.enabled,i=!("throw"!==v(r,"other")||r.envelope.enabled&&r.envelope.errors.other),a=!("return"!==v(r,"other")||r.envelope.enabled&&r.envelope.errors.other),s=!("throw"!==v(r,"execution")||r.envelope.enabled&&r.envelope.errors.execution),u=!("return"!==v(r,"execution")||r.envelope.enabled&&r.envelope.errors.execution);if(t instanceof Error){if(i)throw t;return a?t:o?{errors:[t]}:t}if(t.value.errors&&t.value.errors.length>0){const e=new f("One or more errors in the execution result.",{},t.value.errors.map((e=>{if(e instanceof Error)return e;const{message:t,...n}=e;return new m(t,n)})));if(s)throw e;return u?e:o?{...t.value,errors:[...t.value.errors??[],e]}:e}return o?t.value:t.value.data},g=e=>{const t={discriminant:e.discriminant,inputDefaults:e.inputDefaults,steps:{}},n={type:t,config:()=>n,defaults:e=>(t.inputDefaults=e,n),configInit:()=>n,stepWithExtendedInput:()=>n.step,step:(e,r)=>(t.steps[e]={name:e,...r},n)};return n};var E;!function(e){e.create=e=>{let t=e.steps;e.overloads.length>0&&(t=t.map((t=>{const n=e.overloads.map((e=>{const n=e.steps[t.name];return n?{...n,discriminant:e.discriminant}:null})).filter((e=>null!==e));return{name:t.name,run:(...e)=>{const r=e[0],o=n.find((e=>r[e.discriminant[0]]===e.discriminant[1]));return o?o.run(...e):t.run(...e)},slots:{...t.slots,...n.reduce(((e,t)=>({...e,...t.slots})),{})}}})));const n=(e=>new Map(e.map((e=>[e.name,e]))))(t);return{...e,steps:t,stepsIndex:n}}}(E||(E={}));const N=async(e,t)=>{const n=$(e);return await n(t)},b=e=>{const t={type:e,input:()=>t,done:()=>E.create(e),stepWithRunnerType:()=>t.step,step:(...t)=>{const n="string"==typeof t[0]?{name:t[0],run:S,...t[1]}:{run:S,...t[0]};return b({...e,steps:[...e.steps,n]})},use:t=>b({...e,overloads:[...e.overloads,...t.type.overloads]}),overload:t=>{const n=t({create:g});return e.overloads.push(n.type),b(e)}};return t},S=e=>e.input,k=/^(?:(?<async>async)\s+)?(?:function\s+)?(?:(?<name>[A-z_0-9]+)\s*)?\((?<parameters>[^)]*)\)\s*(?:=>\s*(?<bodyExpression>[^\s{].*)|(?:=>\s*)?{(?<bodyStatement>.*)})$/s,I=/(?<destructured>\{[^}]+\})|(?<name>[A-z_][A-z_0-9]*)/gs,w=/(?<name>[A-z_][A-z_0-9]*)(?::[^},]+)?/gs;class T extends m{constructor(e){super("Interceptor must destructure the first parameter passed to it and select exactly one step.",e)}}const x="multipleParameters",D="noParameters",O="notDestructured",A="destructuredWithoutEntryHook",C="multipleDestructuredHookNames",V="invalidDestructuredHookNames",F=Symbol("resultEnvelope"),j=e=>({[F]:F,result:e});var q;!function(e){e.create=(e,t)=>(t.input=e,t)}(q||(q={}));const _=e=>({...e,currentChunk:a()}),P=async({pipeline:e,name:t,done:n,inputOriginalOrFromExtension:i,previousStepsCompleted:s,interceptorsStack:l,nextInterceptorsStack:c,asyncErrorDeferred:p,customSlots:d})=>{const f=u(`step ${t}:`);f("advance to next interceptor");const[v,...h]=l;if(!(0===h.length)&&v?.retrying&&n({type:"error",source:"user",extensionName:v.name,hookName:t,error:new m("Only the last extension can retry hooks.",{extensionsAfter:h.map((e=>({name:e.name})))})}),v){const l=u(`hook ${t}: extension ${v.name}:`),y=a();l("start");let g=!1;const E=q.create(i,(r=>{l("extension calls this hook",r);const o=r?.input??i,u={...d,...r?.using};if(y.isResolved()){if(v.retrying){if(g){l("execute branch: retry");const o=_(v);return P({pipeline:e,name:t,done:n,previousStepsCompleted:s,inputOriginalOrFromExtension:i,asyncErrorDeferred:p,interceptorsStack:[o],nextInterceptorsStack:c,customSlots:u}),o.currentChunk.promise.then((async e=>{const n=e[t];if(!n)throw Error("Hook not found in envelope: "+t);return await n({...r,input:r?.input??i})}))}return p.resolve({type:"error",source:"extension",interceptorName:v.name,hookName:t,error:new m("Only after failure can a hook be called again by a retrying extension.",{hookName:t,extensionName:v.name})}),a().promise}return p.resolve({type:"error",source:"extension",interceptorName:v.name,hookName:t,error:new m("Only a retrying extension can retry hooks.",{hookName:t,extensionsAfter:h.map((e=>({name:e.name})))})}),a().promise}{const r=_(v),i=[...c,r];return y.resolve(!0),P({pipeline:e,name:t,done:n,previousStepsCompleted:s,asyncErrorDeferred:p,inputOriginalOrFromExtension:o,interceptorsStack:h,nextInterceptorsStack:i,customSlots:u}),r.currentChunk.promise.then((e=>(e instanceof Error&&(l("received hook error"),g=!0),e)))}}));l("advance with envelope");const N={[t]:E};v.currentChunk.resolve(N),f("start race between extension returning or invoking next hook");const{branch:b,result:S}=await Promise.race([y.promise.then((e=>({branch:"hookInvoked",result:e}))).catch((e=>({branch:"hookInvokedButThrew",result:e}))),v.body.promise.then((e=>({branch:"extensionReturned",result:e}))).catch((e=>({branch:"extensionThrew",result:e})))]);switch(b){case"hookInvoked":return void l("invoked next hook (or retrying extension got error pushed through)");case"extensionReturned":return l("extension returned"),void(S===N?P({pipeline:e,name:t,done:n,previousStepsCompleted:s,inputOriginalOrFromExtension:i,asyncErrorDeferred:p,interceptorsStack:h,nextInterceptorsStack:c,customSlots:d}):n({type:"shortCircuited",result:S}));case"extensionThrew":return l("extension threw"),void n({type:"error",hookName:t,source:"extension",error:r(S),interceptorName:v.name});case"hookInvokedButThrew":return l("hook error"),void n({type:"error",hookName:t,source:"implementation",error:r(S)});default:throw o(b)}}else{f("no more interceptors to advance, run implementation");const o=e.stepsIndex.get(t);if(!o)throw new m("Implementation not found for step name "+t,{hookName:t});let a;try{const e={...o.slots,...d};a=await o.run(i,e,s)}catch(e){f("implementation error");const o=c[c.length-1];return void(o&&o.retrying?o.currentChunk.resolve(r(e)):n({type:"error",hookName:t,source:"implementation",error:r(e)}))}f("completed"),n({type:"completed",result:a,effectiveInput:i,nextExtensionsStack:c})}},R=async({pipeline:e,stepsToProcess:t,originalInputOrResult:n,interceptorsStack:r,asyncErrorDeferred:i,previousStepsCompleted:u})=>{const[l,...c]=t;if(!l){s("pipeline: ending");const e=await M({interceptorsStack:r,result:n});return s("pipeline: returning"),j(e)}s(`hook ${l.name}: start`);const p=a({strict:!1});P({pipeline:e,name:l.name,done:p.resolve,inputOriginalOrFromExtension:n,previousStepsCompleted:u,interceptorsStack:r,asyncErrorDeferred:i,customSlots:{},nextInterceptorsStack:[]});const d=await Promise.race([p.promise,i.promise]);switch(d.type){case"completed":{const{result:t,effectiveInput:n,nextExtensionsStack:r}=d,o={...u,[l.name]:{input:n}};return await R({pipeline:e,stepsToProcess:c,originalInputOrResult:t,interceptorsStack:r,previousStepsCompleted:o,asyncErrorDeferred:i})}case"shortCircuited":{s("signal: shortCircuited");const{result:e}=d;return j(e)}case"error":{if(s("signal: error"),e.config.passthroughErrorWith?.(d))return d.error;if(e.config.passthroughErrorInstanceOf.some((e=>d.error instanceof e)))return d.error;const t=i.isResolved();switch(d.source){case"extension":{const e="anonymous"===d.interceptorName?" (use named functions to improve this error message)":"";return new m(t?`There was an error in the interceptor "${d.interceptorName}"${e}.`:`There was an error in the interceptor "${d.interceptorName}"${e} while running hook "${d.hookName}".`,{hookName:d.hookName,source:d.source,interceptorName:d.interceptorName},d.error)}case"implementation":return new m(`There was an error in the core implementation of hook "${d.hookName}".`,{hookName:d.hookName,source:d.source},d.error);case"user":return d.error;default:throw o(d)}}default:throw o(d)}},M=async({interceptorsStack:e,result:t})=>{const[n,...r]=e;if(!n)return t;s(`interceptor ${n.name}: end`),n.currentChunk.resolve(t);const o=await n.body.promise;return await M({interceptorsStack:r,result:o})},$=e=>async t=>{const{initialInput:n,interceptors:r=[],retryingInterceptor:o}=t??{};var i;const s=(o?[...r,(i=o,{retrying:!0,run:i})]:r).map((t=>U(e,t))),[u,l]=(e=>{const[t,n]=(e=>{const t=[],n=[];for(const r of e)r instanceof Error?t.push(r):n.push(r);return[n,t]})(e);return[t,n.length>0?new f("One or more extensions are invalid.",{},n):null]})(s);if(l)return l;const c=a({strict:!1}),p=await R({pipeline:e,stepsToProcess:e.steps,originalInputOrResult:n,interceptorsStack:u,asyncErrorDeferred:c,previousStepsCompleted:{}});return p instanceof Error?p:(e=>({value:e}))(p.result)},U=(e,t)=>{const n=a(),r=a(),i="function"==typeof t?t:t.run,s="function"!=typeof t&&t.retrying,u=async e=>{try{const t=await i(e);r.resolve(t)}catch(e){r.reject(e)}},l=i.name||"anonymous";switch(e.config.entrypointSelectionMode){case"off":return n.promise.then(u),{name:l,entrypoint:e.steps[0]?.name,body:r,currentChunk:n};case"optional":case"required":{const t=((e,t)=>{const n=e.stepsIndex,r=(e=>{const t=(""+e).match(k)?.groups;if(!t)throw Error("Could not extract groups from function.");const n=t.bodyStatement??t.bodyExpression;if(void 0===n)throw Error("Could not extract body from function.");const r=[];if(t.parameters){const e=[...t.parameters.matchAll(I)].map((e=>{const t=e.groups?.destructured?"destructured":e.groups?.name?"name":null;switch(t){case"destructured":return{type:t,names:[...e.groups.destructured.matchAll(w)].map((e=>{const t=e.groups.name;if(void 0===t)throw Error("Could not extract name from destructured parameter.");return t}))};case"name":return{type:t,value:e.groups.name};case null:throw Error("Could not determine type of parameter.");default:throw o(t)}}));r.push(...e)}return{body:n,parameters:r}})(t);if(r.parameters.length>1)return new T({issue:x});const i=r.parameters[0];if(i){if("name"===i.type)return new T({issue:O});{if(0===i.names.length)return new T({issue:A});const e=i.names.filter((e=>n.has(e)));if(e.length>1)return new T({issue:C});const t=e[0];return t?n.get(t)||new T({issue:A}):new T({issue:V})}}return new T({issue:D})})(e,i);if(t instanceof Error)return"required"===e.config.entrypointSelectionMode?t:(n.promise.then(u),{name:l,entrypoint:e.steps[0]?.name,body:r,currentChunk:n});const a=[];for(const n of e.steps){if(n===t)break;a.push(n.name)}const c=a.map((e=>L(e)));let p=n.promise;for(const e of c)p=p.then(e);return p.then(u),{retrying:s,name:l,entryStep:t,body:r,currentChunk:n}}default:throw o(e.config.entrypointSelectionMode)}},L=e=>async t=>{const n=t[e];if(!n)throw new m("Hook not found in hook envelope",{hookName:e});return await n({input:n.input})};class B extends Error{constructor(e,t,n,r,o,i,a){super(e),this.name="GraphQLError",this.message=e,o&&(this.path=o),t&&(this.nodes=Array.isArray(t)?t:[t]),n&&(this.source=n),r&&(this.positions=r),i&&(this.originalError=i);var s=a;if(!s&&i){var u=i.extensions;u&&"object"==typeof u&&(s=u)}this.extensions=s||{}}toJSON(){return{...this,message:this.message}}toString(){return this.message}get[Symbol.toStringTag](){return"GraphQLError"}}var Y,W;function z(e){return new B(`Syntax Error: Unexpected token at ${W} in ${e}`)}function J(e){if(e.lastIndex=W,e.test(Y))return Y.slice(W,W=e.lastIndex)}var H=/ +(?=[^\s])/y;function G(e){for(var t=e.split("\n"),n="",r=0,o=0,i=t.length-1,a=0;t.length>a;a++)H.lastIndex=0,H.test(t[a])&&(!a||r&&H.lastIndex>=r||(r=H.lastIndex),o=o||a,i=a);for(var s=o;i>=s;s++)s!==o&&(n+="\n"),n+=t[s].slice(r).replace(/\\"""/g,'"""');return n}function X(){for(var e=0|Y.charCodeAt(W++);9===e||10===e||13===e||32===e||35===e||44===e||65279===e;e=0|Y.charCodeAt(W++))if(35===e)for(;10!==(e=Y.charCodeAt(W++))&&13!==e;);W--}var Q,Z=/[_A-Za-z]\w*/y,K=RegExp("(?:(null|true|false)|\\$("+Z.source+')|(-?\\d+)((?:\\.\\d+)?[eE][+-]?\\d+|\\.\\d+)?|("""(?:"""|(?:[\\s\\S]*?[^\\\\])"""))|("(?:"|[^\\r\\n]*?[^\\\\]"))|('+Z.source+"))","y"),ee=((Q=ee||{})[Q.Const=1]="Const",Q[Q.Var=2]="Var",Q[Q.Int=3]="Int",Q[Q.Float=4]="Float",Q[Q.BlockString=5]="BlockString",Q[Q.String=6]="String",Q[Q.Enum=7]="Enum",Q),te=/\\/;function ne(e){var t,n;if(K.lastIndex=W,91===Y.charCodeAt(W)){W++,X();for(var r=[];93!==Y.charCodeAt(W);)r.push(ne(e));return W++,X(),{kind:"ListValue",values:r}}if(123===Y.charCodeAt(W)){W++,X();for(var o=[];125!==Y.charCodeAt(W);){if(null==(t=J(Z)))throw z("ObjectField");if(X(),58!==Y.charCodeAt(W++))throw z("ObjectField");X(),o.push({kind:"ObjectField",name:{kind:"Name",value:t},value:ne(e)})}return W++,X(),{kind:"ObjectValue",fields:o}}if(null!=(n=K.exec(Y))){if(W=K.lastIndex,X(),null!=(t=n[ee.Const]))return"null"===t?{kind:"NullValue"}:{kind:"BooleanValue",value:"true"===t};if(null!=(t=n[ee.Var])){if(e)throw z("Variable");return{kind:"Variable",name:{kind:"Name",value:t}}}var i;if(null!=(t=n[ee.Int]))return null!=(i=n[ee.Float])?{kind:"FloatValue",value:t+i}:{kind:"IntValue",value:t};if(null!=(t=n[ee.BlockString]))return{kind:"StringValue",value:G(t.slice(3,-3)),block:!0};if(null!=(t=n[ee.String]))return{kind:"StringValue",value:te.test(t)?JSON.parse(t):t.slice(1,-1),block:!1};if(null!=(t=n[ee.Enum]))return{kind:"EnumValue",value:t}}throw z("Value")}function re(e){if(40===Y.charCodeAt(W)){var t,n=[];W++,X();do{if(null==(t=J(Z)))throw z("Argument");if(X(),58!==Y.charCodeAt(W++))throw z("Argument");X(),n.push({kind:"Argument",name:{kind:"Name",value:t},value:ne(e)})}while(41!==Y.charCodeAt(W));return W++,X(),n}}function oe(e){if(64===Y.charCodeAt(W)){var t,n=[];do{if(W++,null==(t=J(Z)))throw z("Directive");X(),n.push({kind:"Directive",name:{kind:"Name",value:t},arguments:re(e)})}while(64===Y.charCodeAt(W));return n}}function ie(){for(var e,t=0;91===Y.charCodeAt(W);)t++,W++,X();if(null==(e=J(Z)))throw z("NamedType");X();var n={kind:"NamedType",name:{kind:"Name",value:e}};do{if(33===Y.charCodeAt(W)&&(W++,X(),n={kind:"NonNullType",type:n}),t){if(93!==Y.charCodeAt(W++))throw z("NamedType");X(),n={kind:"ListType",type:n}}}while(t--);return n}var ae=RegExp("(?:(\\.{3})|("+Z.source+"))","y"),se=function(e){return e[e.Spread=1]="Spread",e[e.Name=2]="Name",e}(se||{});function ue(){var e,t,n=[];do{if(ae.lastIndex=W,null==(t=ae.exec(Y)))throw z("SelectionSet");if(W=ae.lastIndex,null!=t[se.Spread]){X();var r=J(Z);if(null!=r&&"on"!==r)X(),n.push({kind:"FragmentSpread",name:{kind:"Name",value:r},directives:oe(!1)});else{if(X(),"on"===r){if(null==(r=J(Z)))throw z("NamedType");X()}var o=oe(!1);if(123!==Y.charCodeAt(W++))throw z("InlineFragment");X(),n.push({kind:"InlineFragment",typeCondition:r?{kind:"NamedType",name:{kind:"Name",value:r}}:void 0,directives:o,selectionSet:ue()})}}else if(null!=(e=t[se.Name])){var i=void 0;if(X(),58===Y.charCodeAt(W)){if(W++,X(),i=e,null==(e=J(Z)))throw z("Field");X()}var a=re(!1);X();var s=oe(!1),u=void 0;123===Y.charCodeAt(W)&&(W++,X(),u=ue()),n.push({kind:"Field",alias:i?{kind:"Name",value:i}:void 0,name:{kind:"Name",value:e},arguments:a,directives:s,selectionSet:u})}}while(125!==Y.charCodeAt(W));return W++,X(),{kind:"SelectionSet",selections:n}}function le(){var e,t;if(null==(e=J(Z)))throw z("FragmentDefinition");if(X(),"on"!==J(Z))throw z("FragmentDefinition");if(X(),null==(t=J(Z)))throw z("FragmentDefinition");X();var n=oe(!1);if(123!==Y.charCodeAt(W++))throw z("FragmentDefinition");return X(),{kind:"FragmentDefinition",name:{kind:"Name",value:e},typeCondition:{kind:"NamedType",name:{kind:"Name",value:t}},directives:n,selectionSet:ue()}}var ce=/(?:query|mutation|subscription|fragment)/y;function pe(e){var t,n,r;if(e&&(X(),t=J(Z),n=function(){if(X(),40===Y.charCodeAt(W)){var e,t=[];W++,X();do{if(36!==Y.charCodeAt(W++))throw z("Variable");if(null==(e=J(Z)))throw z("Variable");if(X(),58!==Y.charCodeAt(W++))throw z("VariableDefinition");X();var n=ie(),r=void 0;61===Y.charCodeAt(W)&&(W++,X(),r=ne(!0)),X(),t.push({kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:e}},type:n,defaultValue:r,directives:oe(!0)})}while(41!==Y.charCodeAt(W));return W++,X(),t}}(),r=oe(!1)),123===Y.charCodeAt(W))return W++,X(),{kind:"OperationDefinition",operation:e||"query",name:t?{kind:"Name",value:t}:void 0,variableDefinitions:n,directives:r,selectionSet:ue()}}function de(e,t,n){for(var r="",o=0;e.length>o;o++)o&&(r+=t),r+=n(e[o]);return r}var me="\n",fe={OperationDefinition(e){var t=e.operation;return e.name&&(t+=" "+e.name.value),e.variableDefinitions&&e.variableDefinitions.length&&(e.name||(t+=" "),t+="("+de(e.variableDefinitions,", ",fe.VariableDefinition)+")"),e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),"query"!==t?t+" "+fe.SelectionSet(e.selectionSet):fe.SelectionSet(e.selectionSet)},VariableDefinition(e){var t=fe.Variable(e.variable)+": "+ve(e.type);return e.defaultValue&&(t+=" = "+ve(e.defaultValue)),e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),t},Field(e){var t=e.alias?e.alias.value+": "+e.name.value:e.name.value;if(e.arguments&&e.arguments.length){var n=de(e.arguments,", ",fe.Argument);t+=t.length+n.length+2>80?"("+(me+="  ")+de(e.arguments,me,fe.Argument)+(me=me.slice(0,-2))+")":"("+n+")"}return e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),e.selectionSet&&e.selectionSet.selections.length&&(t+=" "+fe.SelectionSet(e.selectionSet)),t},StringValue:e=>e.block?function(e){return'"""\n'+e.replace(/"""/g,'\\"""')+'\n"""'}(e.value).replace(/\n/g,me):function(e){return JSON.stringify(e)}(e.value),BooleanValue:e=>""+e.value,NullValue:e=>"null",IntValue:e=>e.value,FloatValue:e=>e.value,EnumValue:e=>e.value,Name:e=>e.value,Variable:e=>"$"+e.name.value,ListValue:e=>"["+de(e.values,", ",ve)+"]",ObjectValue:e=>"{"+de(e.fields,", ",fe.ObjectField)+"}",ObjectField:e=>e.name.value+": "+ve(e.value),Document:e=>e.definitions&&e.definitions.length?de(e.definitions,"\n\n",ve):"",SelectionSet:e=>"{"+(me+="  ")+de(e.selections,me,ve)+(me=me.slice(0,-2))+"}",Argument:e=>e.name.value+": "+ve(e.value),FragmentSpread(e){var t="..."+e.name.value;return e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),t},InlineFragment(e){var t="...";return e.typeCondition&&(t+=" on "+e.typeCondition.name.value),e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),t+" "+fe.SelectionSet(e.selectionSet)},FragmentDefinition(e){var t="fragment "+e.name.value;return t+=" on "+e.typeCondition.name.value,e.directives&&e.directives.length&&(t+=" "+de(e.directives," ",fe.Directive)),t+" "+fe.SelectionSet(e.selectionSet)},Directive(e){var t="@"+e.name.value;return e.arguments&&e.arguments.length&&(t+="("+de(e.arguments,", ",fe.Argument)+")"),t},NamedType:e=>e.name.value,ListType:e=>"["+ve(e.type)+"]",NonNullType:e=>ve(e.type)+"!"},ve=e=>fe[e.kind](e);const he="OperationDefinition",ye="NamedType",ge="query",Ee="mutation",Ne=e=>({kind:"Name",...e}),be=e=>({kind:"Argument",...e}),Se=e=>"object"==typeof e&&null!==e&&"kind"in e&&e.kind===he,ke=e=>({kind:"SelectionSet",...e}),Ie=e=>({kind:ye,...e}),we=e=>({kind:"Field",...e}),Te=e=>({kind:"EnumValue",...e}),xe=e=>({kind:"Variable",...e}),De=e=>({kind:"ListValue",...e}),Oe={query:"read",mutation:"write",subscription:"read"},Ae=e=>{const t=e;return c(t)?t:function(e){return me="\n",fe[e.kind]?fe[e.kind](e):""}(t)},Ce=e=>e.kind===ye?e:Ce(e.type),Ve=e=>{for(const t of e.query.definitions){const n=Se(t)?t:null;if(!e.operationName)return n;if(n?.name?.value===e.operationName)return n}return null},Fe=RegExp(`^\\b(${Object.values(Object.freeze({__proto__:null,MUTATION:Ee,QUERY:ge,SUBSCRIPTION:"subscription"})).join("|")})\\b`),je=e=>{const t=e;return c(t)?function(e){return W=0,function(e){var t,n;X();var r,o=[];do{if("fragment"===(t=J(ce)))X(),o.push(le());else{if(null==(n=pe(t)))throw z("Document");o.push(n)}}while(e.length>W);return{kind:"Document",definitions:o,set loc(e){r=e},get loc(){return r||(r={start:0,end:e.length,startToken:void 0,endToken:void 0,source:{body:e,name:"graphql.web",locationOffset:{line:1,column:1}}}),r}}}(Y="string"==typeof e.body?e.body:e)}(t):t},qe=(e,t)=>{const n="object"==typeof t.output?.envelope?{enabled:!0,...t.output.envelope}:"boolean"==typeof t.output?.envelope?{enabled:t.output.envelope}:void 0,r={name:t.name??e?.name??Ot,schemaMap:t.schemaMap??e.schemaMap,output:{defaults:{errorChannel:t.output?.defaults?.errorChannel??e.output.defaults.errorChannel},envelope:{enabled:n?.enabled??e.output.envelope.enabled,errors:{execution:n?.errors?.execution??e.output.envelope.errors.execution,other:n?.errors?.other??e.output.envelope.errors.other,schema:n?.errors?.schema??e.output.envelope.errors.schema}},errors:{execution:t.output?.errors?.execution??e.output.errors.execution,other:t.output?.errors?.other??e.output.errors.other,schema:t.output?.errors?.schema??e.output.errors.schema}}};return At.withTypeLevel({...e,...r})},_e=e=>{const t=je(e.query);if("operation"in e){const n=Ve({...e,query:je(e.query)});return{...e,operation:n,query:t}}return{...e,query:t}},Pe=e=>{if(void 0===e)return;if(null===e)return null;if("object"!=typeof e)return e;if(Array.isArray(e))return e.map(Pe);if(!function(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t))&&"[object Object]"==={}.toString.call(e)}(e))return e;const t={};for(const n in e){const r=n.replace(/^\$/,""),o=Pe(e[n]);t[r]=o}return t},Re=(e,t)=>Me(e,t),Me=(e,t)=>{if(e===$e)return{type:"Arguments",arguments:t};const n=nt(e);if(n){const r=tt[n];if(!r)throw Error(`Unknown directive ${e}.`);return{type:"Directive",name:n,arguments:void 0===t?null:{input:t,parsed:r.normalizeArguments(t)}}}if(e===Et)return{type:"ScalarsWildcard"};if(mt(t))return{type:"Indicator",name:e,select:dt(t)};const r=ht(e);if(r){const e=vt(t);return{type:"InlineFragment",typeCondition:r.typeCondition,selectionSets:e}}if(yt(t))return{type:"Alias",name:e,aliases:gt(t)};if("object"==typeof t&&null!==t)return{type:"SelectionSet",name:e,selectionSet:t};throw Error(`Unknown selection at key ${e}.`)},$e="$",Ue=e=>e.startsWith("$"),Le=(e,t)=>({kind:"Scalar",name:e,codec:t}),Be={encode:e=>e,decode:e=>e},Ye={encode:e=>e,decode:e=>e},We=Le("String",Be),ze=Le("Boolean",Ye);var Je;!function(e){e.empty={map:{}}}(Je||(Je={}));const He=(e,t)=>e[t]||We,Ge=(e,t)=>null===t?null:Array.isArray(t)?t.map((t=>Ge(e,t))):e(t),Xe=e=>"object"==typeof e&&null!==e&&"codec"in e&&"object"==typeof e.codec,Qe={include:{name:"include",arguments:{if:{name:"if",type:ze}}},skip:{name:"skip",arguments:{if:{name:"if",type:ze}}}},Ze={name:"include",type:Qe.include,normalizeArguments:e=>"boolean"==typeof e?Ke(e):((e,t)=>{const n={...et};for(const e in t)void 0!==t[e]&&(n[e]=t[e]);return n})(0,e)},Ke=e=>({if:e}),et={if:!0},tt={include:Ze,skip:{name:"skip",type:Qe.skip,normalizeArguments:e=>({if:"boolean"==typeof e?e:void 0===e.if||e.if})}},nt=e=>e.startsWith("$")?e.slice(1):null,rt="application/json",ot=(e,t)=>{const n=((e,t)=>{const n=new Headers(e),r=new Headers(t);for(const[e,t]of r.entries())""===t?n.delete(e):n.set(e,t);return n})(e?.headers??{},t?.headers??{});return{...e,...t,headers:n}},it=(e,t)=>{const n=new URL(e);return((e,t)=>{new URLSearchParams(t).forEach(((t,n)=>{e.searchParams.append(n,t)}))})(n,t),n},at=`application/graphql-response+json; charset=utf-8, ${rt}; charset=utf-8`,st={accept:at,"content-type":rt},ut={accept:at},lt=e=>({query:e.query,...e.variables?{variables:JSON.stringify(e.variables)}:{},...e.operationName?{operationName:e.operationName}:{}}),ct=e=>JSON.stringify({query:e.query,variables:e.variables,operationName:e.operationName}),pt="__default__",dt=e=>true===e,mt=e=>dt(e)||(e=>false===e||undefined===e)(e),ft=/^___(?:on_(?<typeCondition>.+))?$/,vt=e=>Array.isArray(e)?e:[e],ht=e=>{const t=e.match(ft);return t?{typeCondition:t.groups?.typeCondition??null}:null},yt=e=>Array.isArray(e)&&(2===e.length&&"string"==typeof e[0]||yt(e[0])),gt=e=>(e=>"string"==typeof e[0])(e)?[e]:e,Et="$scalars",Nt=e=>!!e&&!c(e)&&"k"in e&&"enum"===e.k,bt=e=>c(e),St=Xe,kt=e=>Xe(e)||bt(e),It=e=>{const{parentContext:t,value:n,sddmNode:r,documentPart:o,scalars:i}=e;var a;if(null!==n)if(Array.isArray(n))n.forEach(((e,t)=>{It({parentContext:{type:"list",object:n,index:t},value:e,sddmNode:r,documentPart:o,scalars:i})}));else if("object"==typeof n){if(!(a=r)||c(a)||!("f"in a))return;const e=n;for(const[t,n]of Object.entries(e)){const a=wt(o,t),s=r.f[a?.name.value??t];s?.nt&&It({parentContext:{type:"object",object:e,fieldName:t},value:n,sddmNode:s.nt,documentPart:a?.selectionSet??null,scalars:i})}}else{if(!t)return;if(St(r)){const e=Ge(r.codec.decode,n);"object"===t.type?t.object[t.fieldName]=e:t.object[t.index]=e}else if(bt(r)){const e=He(i,r),o=Ge(e.codec.decode,n);"object"===t.type?t.object[t.fieldName]=o:t.object[t.index]=o}}},wt=(e,n)=>{if(!e)return null;for(const r of e.selections){if(r.kind===t.FIELD&&(r.alias?.value??r.name.value)===n)return r;if(r.kind===t.INLINE_FRAGMENT){const e=wt(r.selectionSet,n);if(null!==e)return e}}return null},Tt=(e,t,n,r,o)=>{if(bt(r)){const i=He(o,r);e[t]=Ge(i.codec.encode,n)}else{var i;if(St(r))e[t]=Ge(r.codec.encode,n);else if((i=r)&&!c(i)&&"f"in i)for(const e of r.fcs??[]){if("object"!=typeof n||null===n)continue;const t=n[e];if(void 0===t)continue;const i=r.f?.[e];i?.nt&&Tt(n,e,t,i.nt,o)}}},xt=(e=>{const t=(e=>({passthroughErrorInstanceOf:e?.passthroughErrorInstanceOf??[],passthroughErrorWith:e?.passthroughErrorWith,entrypointSelectionMode:e?.entrypointSelectionMode??"required"}))(e);return b({steps:[],config:t,overloads:[]})})({passthroughErrorWith:e=>"exchange"===e.hookName&&(e=>e instanceof DOMException&&"AbortError"===e.name||e instanceof Error&&e.message.startsWith("AbortError:"))(e.error)}).input().step("encode",{run:e=>{const t=e.state.schemaMap,n=e.state.scalars.map;if(t){const r=_e(e.request);e.request.query=r.query,(({sddm:e,request:t,scalars:n})=>{const r=t.operation.variableDefinitions;if(!r)return;const o=new Map(r.map((e=>[e.variable.name.value,e]))),i=t.variables??{};for(const t in i){const r=o.get(t);if(!r)continue;const a=i[t];if(void 0===a)continue;const s=Ce(r.type),u=e.types[s.name.value];u&&Tt(i,t,a,u,n)}})({sddm:t,scalars:n,request:r})}return e.request.variables=Pe(e.request.variables),e}}).step("pack").step("exchange").step("unpack").step("decode",{run:(e,t,n)=>(e.state.schemaMap&&!(!e.result.data&&(e.result.errors?.length??0)>0)&&(({request:e,data:t,sddm:n,scalars:r})=>{const o=n.operations[e.operation.operation];o&&t&&It({parentContext:null,value:t,sddmNode:o,documentPart:e.operation.selectionSet,scalars:r})})({sddm:e.state.schemaMap,request:_e(n.pack.input.request),data:e.result.data,scalars:e.state.scalars.map}),"http"===e.transportType?{...e.result,response:e.response}:e.result)}).type;var Dt;!function(e){(e.States||(e.States={})).empty={registry:{},configurations:{},current:null}}(Dt||(Dt={}));const Ot="default";var At;!function(e){e.withTypeLevel=e=>e,(e.States||(e.States={})).empty={name:Ot,requestPipelineDefinition:xt,transports:Dt.States.empty,checkPreflight:!0,input:{},output:h,schemaMap:null,extensions:[],scalars:Je.empty}}(At||(At={}));const Ct=e=>{if(e.it){const t=1===e.it[0]?"!":"",n=Ft(e);return Vt(e.it[1],n)+t}return Ft(e)},Vt=(e,t)=>{if(!e)return t;const n=1===e[0]?"!":"";return`[${Vt(e[1],t)}${n}]`},Ft=e=>{if(St(e.nt))return e.nt.name;if(bt(e.nt))return e.nt;if(e.nt?.n)return e.nt.n;throw Error("Unknown sddm node: "+e)},jt=(e,t,n)=>{if(kt(t?.nt)){const r=St(t.nt)?t.nt:He(e.scalars,t.nt);return qt(e,r,n)}if(Nt(t?.nt))return Te({value:n+""});if(null===n)return{kind:"NullValue"};if(Array.isArray(n))return De({values:n.map((n=>jt(e,t,n)))});if("object"==typeof n){const o=t?.nt;return r={fields:Object.entries(n).map((([t,n])=>{return r={name:Ne({value:t}),value:jt(e,o?.f?.[t],n)},{kind:"ObjectField",...r};var r}))},{kind:"ObjectValue",...r}}var r,o,i,a;if("string"==typeof n)return e.value.isEnum?Te({value:n+""}):(o={value:n},{kind:"StringValue",...o});if("boolean"==typeof n)return i={value:n},{kind:"BooleanValue",...i};if("number"==typeof n)return a={value:n+""},{kind:"FloatValue",...a};throw Error("Unsupported value: "+n)},qt=(e,t,n)=>{if(null===n)return{kind:"NullValue"};if(Array.isArray(n))return De({values:n.map((n=>qt(e,t,n)))});const r=t.codec.encode(n);return jt(e,void 0,r)},_t=(e,t,n,r)=>{switch(n.type){case"Directive":{const t=((e,t,n)=>{if(null===n.arguments)return null;const r=[];for(const o in n.arguments.parsed){const i=n.arguments.parsed[o],a=t?.[o];let s;if(e.variables.enabled&&a)s=e.variables.capture({name:o,value:i,sddmArgument:a});else{const t=Ne({value:o}),n=jt({...e,value:{isEnum:!1}},a,i);s=be({name:t,value:n})}r.push(s)}return(e=>({kind:"Directive",...e}))({name:Ne({value:n.name}),arguments:r})})(e,e.sddm?.directives[n.name],n);t&&r.directives.push(t);break}default:r.selections.push(...Mt(e,t,n))}},Pt=(e,t,n)=>{const r={...e,value:{isEnum:Ue(n.name)}},o=jt(r,t,n.value),i=Ne({value:n.name.replace(/^\$/g,"")});return be({name:i,value:o})},Rt=(e,t,n)=>{const r=((e,t)=>Me(e,t))(n.name,n.value),o=n.alias?Ne({value:n.alias}):void 0;if("Indicator"===r.type)return r.select?we({name:Ne({value:n.name}),alias:o}):null;const i=[],a=[],s=[];for(const n in r.selectionSet){const o=Me(n,r.selectionSet[n]);if("Arguments"!==o.type){if(kt(t?.nt)||(u=t?.nt,u&&!c(u)&&"a"in u)||Nt(t?.nt))throw Error("schema map scalar on non-scalar graffle selection.");_t(e,t?.nt,o,{directives:a,selections:s})}else{const n=t?.a;for(const t in o.arguments){const r=t.replace(/^\$/,""),a=n?.[r],s=o.arguments[t];if(e.variables.enabled&&a){const t=e.variables.capture({name:r,value:s,sddmArgument:a});i.push(t)}else{const n=Pt(e,a,{name:t,value:s});i.push(n)}}}}var u;const l=0===s.length?void 0:ke({selections:s});return we({name:Ne({value:n.name}),alias:o,arguments:i,directives:a,selectionSet:l})},Mt=(e,t,n)=>{switch(n.type){case"Indicator":return n.select?[we({name:Ne({value:n.name})})]:[];case"InlineFragment":return((e,t,n)=>n.selectionSets.map((r=>((e,t,n)=>{const r=n.typeCondition?Ie({name:Ne({value:n.typeCondition})}):void 0,o=[],i=[];for(const r in n.selectionSet){const a=Re(r,n.selectionSet[r]);_t(e,t,a,{directives:o,selections:i})}return(e=>({kind:"InlineFragment",...e}))({typeCondition:r,directives:o,selectionSet:ke({selections:i})})})(e,t,{selectionSet:r,typeCondition:n.typeCondition}))))(e,t,n);case"Alias":{const r=t?.f[n.name];return n.aliases.map((t=>Rt(e,r,{name:n.name,alias:t[0],value:t[1]}))).filter(p)}case"SelectionSet":{const r=t?.f[n.name];return[Rt(e,r,{alias:null,name:n.name,value:n.selectionSet})].filter(p)}case"ScalarsWildcard":throw Error("todo");default:throw o(n)}},$t=(e,t,n)=>{const r=(e=>{const t={sddm:e?.sddm??void 0,scalars:e?.scalars??{},variables:{enabled:e?.operationVariables??!0,capture:e=>{let n=e.name,r=2;for(;t.variables.data.find((e=>e.name===n));)n=`${e.name}_${r+""}`,r++;return t.variables.data.push({name:n,typeName:Ct(e.sddmArgument),value:e.value}),be({name:Ne({value:e.name}),value:xe({name:Ne({value:n})})})},data:[]}};return t})(n),o=t.name?Ne({value:t.name}):void 0,i=((e,t,n)=>ke({selections:Object.entries(n).map((([e,t])=>((e,t)=>Me(e,t))(e,t))).flatMap((n=>Mt(e,t,n)))}))(r,e,t.selectionSet),a=r.variables.data.map((e=>{return t={variable:xe({name:Ne({value:e.name})}),type:Ie({name:Ne({value:e.typeName})})},{kind:"VariableDefinition",...t};var t})),s=(e=>({kind:he,...e}))({operation:t.type,name:o,selectionSet:i,variableDefinitions:a});return{operation:s,variables:Object.fromEntries(r.variables.data.map((e=>[e.name,e.value])))}},Ut=(t,n)=>({document:Lt(n),query:Bt(n,e.QUERY),mutation:Bt(n,e.MUTATION)}),Lt=e=>t=>{const n=(e=>{const t=Object.entries(e.query??{}).map((([e,t])=>[e,{name:e,type:ge,selectionSet:t}])),n=Object.entries(e.mutation??{}).map((([e,t])=>[e,{name:e,type:Ee,selectionSet:t}])),r=[...t,...n],o=t.filter((([e,t])=>n.some((([e,n])=>n.name===t.name))));if(o.length>0)throw{errors:[Error(`Document has multiple uses of operation name(s): ${o.join(", ")}.`)]};const i=r.length>1;if(0===r.length)throw{errors:[Error("Document has no operations.")]};return{operations:Object.fromEntries(r),facts:{hasMultipleOperations:i}}})(t);return{run:async t=>await zt(e,n,t)}},Bt=(e,t)=>new Proxy({},{get:(n,r)=>{if((e=>"symbol"==typeof e)(r))throw Error("Symbols not supported.");if(r.startsWith("$batch"))return async n=>Wt(e,t,n);{const n=r;return r=>Yt(e,t,n,r)}}}),Yt=async(e,t,n,r)=>{const o=await Wt(e,t,{[n]:r??{}});return o instanceof Error||e.output.envelope.enabled?o:o[n]},Wt=async(e,t,n)=>zt(e,((e,t)=>({operations:{[pt]:{name:null,type:e,selectionSet:t}},facts:{hasMultipleOperations:!1}}))(t,n)),zt=async(e,t,n)=>{if(!e.transports.current)throw Error("No transport configured.");const r=Jt(((e,t)=>{const n=Object.values(e.operations).map((e=>{const n=t?.sddm?.operations[e.type];return $t(n,e,t)}));var r;return{document:(r={definitions:n.map((e=>e.operation))},{kind:"Document",...r}),operationsVariables:Object.fromEntries(n.map((e=>[e.operation.name?.value??"$default",e.variables])))}})(t,{sddm:e.schemaMap,scalars:e.scalars.map}),n),o={transportType:e.transports.current,...e.transports.configurations[e.transports.current],state:e,request:r},i=E.create(e.requestPipelineDefinition),a=await N(i,{initialInput:o,interceptors:e.extensions.filter((e=>void 0!==e.onRequest)).map((e=>e.onRequest))});return y(e,a)},Jt=({document:e,operationsVariables:t},n)=>{const r=n?t[n]:Object.values(t)[0],o=Ve({query:e,operationName:n});if(!o)throw Error(`Unknown operation named "${n+""}".`);return{operationName:n,operation:o,query:e,variables:r}};var Ht;!function(e){e.create=d}(Ht||(Ht={}));const Gt=e=>{const t=t=>{const n=e.normalizeConfig?.(t)??{},r=e.create({config:n}),o=r.builder?.(Ht.create),i=r.transport?.((e=>g({discriminant:["transportType",e]})))?.type;return{name:e.name,config:n,onRequest:r.onRequest,builder:o,transport:i?{name:i.discriminant[1],config:i.input,configInit:void 0,configDefaults:i.inputDefaults,requestPipelineOverload:i}:void 0,typeHooks:{onRequestDocumentRootType:[],onRequestResult:[]}}};return t.info={name:e.name},t},Xt=(e,t)=>({anyware:n=>e({...t,extensions:[...t.extensions,Gt({name:"InlineAnyware",create:()=>({onRequest:n})})()]})}),Qt=e=>({document:(e=>{return Array.isArray(t=e[0])&&"raw"in t&&void 0!==t.raw;var t})(e)?(e=>{const[t,...n]=e;return t.reduce(((e,t,r)=>`${e}${t}${r in n?n[r]+"":""}`),"")})(e):e[0]}),Zt=(e,t)=>({gql:(...e)=>{const{document:n}=Qt(e);return{send:async(...e)=>{if(!t.transports.current)throw Error("No transport selected");const{operationName:r,variables:o}=(e=>({operationName:c(e[0])?e[0]:void 0,variables:c(e[0])?e[1]:e[0]}))(e),i=(e=>{const{operationName:t,query:n}=e,r=n;if(!c(r)){const e=Ve({query:r,operationName:t});if(e)return e.operation;throw Error("Could not parse operation type from document.")}const o=r.split(/[{}\n]+/).map((e=>e.trim())).map((e=>{const t=e.match(Fe);return t?{line:e,operationType:t[0]}:null})).filter((e=>null!==e));if(o.length>1&&!e.operationName)return null;if(0===o.length&&e.operationName)return null;if(0===o.length)return ge;const i=t?o.find((e=>e.line.includes(t))):o[0];return i?i.operationType:null})({query:n,variables:o,operationName:r});if(!i)throw Error("Could not get operation type");const a={transportType:t.transports.current,...t.transports.configurations[t.transports.current],state:t,request:{operation:i,query:n,variables:o,operationName:r}},s=E.create(t.requestPipelineDefinition),u=await N(s,{initialInput:a,interceptors:t.extensions.filter((e=>void 0!==e.onRequest)).map((e=>e.onRequest))});return y(t,u)}}}}),Kt=(e,t)=>({scalar:(...n)=>{const r=Xe(n[0])?n[0]:Le(n[0],n[1]);return e({...t,scalars:{...t.scalars,map:{...t.scalars.map,[r.name]:r}}})}}),en=(e,t)=>({transport:(...n)=>{const r="string"==typeof n[0]?n[0]:t.transports.current,o=("string"==typeof n[0]?n[1]:n[0])??{};if(!r)throw Error("No transport is currently set.");const i=tn(t,r,o);return e(i)}}),tn=(e,t,n)=>{const r={...e.transports.configurations[t]??{},...n};return"http"===t&&n.headers&&(r.headers={...e.transports.configurations[t]?.headers,...n.headers}),{...e,transports:{...e.transports,current:t,configurations:{...e.transports.configurations,[t]:r}}}},nn=(e,t)=>{const n={...e,extensions:[...e.extensions,t]};if(t.transport){if(n.requestPipelineDefinition={...e.requestPipelineDefinition,overloads:[...e.requestPipelineDefinition.overloads,t.transport.requestPipelineOverload]},n.transports={current:e.transports.current,registry:{...e.transports.registry},configurations:{...e.transports.configurations}},void 0!==n.transports.registry[t.transport.name])throw Error(`Transport "${t.transport.name}" is already registered.`);null===n.transports.current&&(n.transports.current=t.transport.name),n.transports.registry[t.transport.name]=t.transport,n.transports.configurations[t.transport.name]={...t.transport.configDefaults,...t.transport.config}}return n},rn=(e,t)=>({use:n=>e(nn(t,n))}),on=e=>{const t={_:e,...(n=on,r=e,{with:e=>n(qe(r,e))}),...en(on,e),...Zt(0,e),...rn(on,e),...Xt(on,e),...Kt(on,e)};var n,r;return Object.assign(t,{...Ut(0,e)}),l(t,(({path:n,property:r})=>{const o=e.extensions.map((e=>e.builder)).filter((e=>void 0!==e));for(const e of o){const o=e({client:t,path:n,property:r});if(void 0!==o)return o}}))},an={methodMode:"post"},sn=Gt({name:"TransportHttp",normalizeConfig:e=>({...an,...e,url:e?.url?new URL(e.url):void 0}),create:({config:e})=>({transport:t=>t("http").config().defaults(e).stepWithExtendedInput()("pack",{slots:{searchParams:lt,body:ct},run:(e,t)=>{const n={operationName:e.request.operationName,variables:e.request.variables,query:Ae(e.request.query)},r=c(e.request.operation)?e.request.operation:e.request.operation.operation,o=e.methodMode,i="post"===o?"post":"read"===Oe[r]?"get":"post",a=ot(ot(ot({headers:"get"===i?ut:st},{headers:e.headers}),e.raw),{headers:e.headers}),s="get"===i?{methodMode:o,...a,method:"get",url:it(e.url,t.searchParams(n))}:{methodMode:o,...a,method:"post",url:e.url,body:t.body(n)};return{...e,request:s}}}).step("exchange",{slots:{fetch:e=>fetch(e)},run:async(e,t)=>{const n=new Request(e.request.url,e.request),r=await t.fetch(n);return{...e,response:r}}}).step("unpack",{run:async e=>{const t=(e=>{if("object"!=typeof e||null===e)throw Error("Invalid execution result: result is not object");if("errors"in e){if(!Array.isArray(e.errors)||e.errors.some((e=>!(i(e)&&"message"in e&&"string"==typeof e.message))))throw Error("Invalid execution result: errors is not array of formatted errors");e.errors.forEach((e=>{if(!(e=>i(e)&&"message"in e&&"string"==typeof e.message)(e))throw Error("Invalid value in errors array.")}))}if("data"in e&&!i(e.data)&&null!==e.data)throw Error("Invalid execution result: data is not plain object");if("extensions"in e&&!i(e.extensions))throw Error("Invalid execution result: extensions is not plain object");return e})(await e.response.json());return{...e,result:t}}})})}),un=(ln=nn(At.States.empty,sn()),e=>{const t=qe(ln,e??{});return on(t)})();var ln;console.log(un);
